

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Luocheng Liang">
  <meta name="keywords" content="">
  
    <meta name="description" content="Introduction Generative Adversarial Networks is invented in 2014 by Ian J.Goodfellow, et. al. as a generative models, its idea derives from the game theory where two player compete against one another">
<meta property="og:type" content="article">
<meta property="og:title" content="GAN and Wasserstein GAN">
<meta property="og:url" content="https://notdesigned.github.io/2025/07/22/GAN-and-Wasserstein-GAN/index.html">
<meta property="og:site_name" content="Adscn&#39;s Blog">
<meta property="og:description" content="Introduction Generative Adversarial Networks is invented in 2014 by Ian J.Goodfellow, et. al. as a generative models, its idea derives from the game theory where two player compete against one another">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-07-22T14:17:15.000Z">
<meta property="article:modified_time" content="2026-02-26T12:57:24.804Z">
<meta property="article:author" content="Luocheng Liang">
<meta property="article:tag" content="GAN">
<meta property="article:tag" content="Generative Models">
<meta property="article:tag" content="Wasserstein Distance">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>GAN and Wasserstein GAN - Adscn&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"notdesigned.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.1.1"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Adscn&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Blog</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="GAN and Wasserstein GAN"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-07-22 14:17" pubdate>
          July 22, 2025 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          287 words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          3 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">GAN and Wasserstein GAN</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="introduction">Introduction</h1>
<p>Generative Adversarial Networks is invented in 2014 by Ian
J.Goodfellow, et. al. as a generative models, its idea derives from the
game theory where two player compete against one another.</p>
<p>So they design an architecture that has two network where one is
responible for generating fake data that is similar from the data and
another one is responible for discriminating between fake and true
data.</p>
<h1 id="mathematics-formulas">Mathematics Formulas</h1>
<p>GAN is formulated as a min-max problem</p>
<p><span class="math display">\[
\min_{G} \max_{D} V(D,G)
\]</span> <span class="math display">\[
V(D,G) = \mathbb{E}_{x \sim p_{data}(x)}[\log D(x)] + \mathbb{E}_{x \sim
p_{g}(x)}[\log(1 - D(x))]
\]</span></p>
<p>Where <span class="math inline">\(D\)</span> is the discriminator,
<span class="math inline">\(G\)</span> is the generator, <span
class="math inline">\(p_{data}(x)\)</span> is the distribution of the
real data, and <span class="math inline">\(p_{g}(x)\)</span> is the
distribution of the noise input to the generator.</p>
<p><span class="math inline">\(V(D,G)\)</span> can be interpreted as the
value function that represents the “distance” between the real data
distribution and the generated data distribution.</p>
<h1 id="network-architecture">Network Architecture</h1>
<p>The architecture of GAN consists of two main components:</p>
<ol type="1">
<li><strong>Generator (G)</strong>:</li>
</ol>
<ul>
<li>Noise input <span class="math inline">\(z\)</span> is sampled from a
prior distribution (e.g., Gaussian or uniform).</li>
<li>Hidden layers transform the noise into a data sample.</li>
<li>Output layer generates a data sample (e.g., image).</li>
</ul>
<ol start="2" type="1">
<li><strong>Discriminator (D)</strong>:</li>
</ol>
<ul>
<li>Takes a data sample (either real or generated).</li>
<li>Hidden layers process the sample.</li>
<li>Output layer produces a probability score indicating whether the
sample is real or fake.</li>
</ul>
<h1 id="training-process">Training Process</h1>
<p>The training process of GAN involves alternating between training the
discriminator and the generator: 1. <strong>Train
Discriminator</strong>: - Sample a batch of real data from the dataset
with label 1. - Sample a batch of noise and generate fake data using the
generator with label 0. - Update the discriminator to maximize its
ability to distinguish real from fake data. 2. <strong>Train
Generator</strong>: - Sample a batch of noise and generate fake data
using the generator. - Update the generator to minimize the
discriminator’s ability to distinguish fake data from real data. 3.
<strong>Repeat</strong>: - Continue alternating between training the
discriminator and the generator until convergence or for a fixed number
of epochs</p>
<h1 id="merits-and-limitations">Merits and Limitations</h1>
<h2 id="merits">Merits</h2>
<ul>
<li><strong>High-Quality Samples</strong>: GANs can generate
high-quality samples that are often indistinguishable from real
data.</li>
<li><strong>Versatile Applications</strong>: GANs can be applied to
various domains, including image generation</li>
<li><strong>Unsupervised Learning</strong>: GANs can learn from
unlabeled data, making them suitable for unsupervised learning
tasks.</li>
</ul>
<h2 id="limitations">Limitations</h2>
<ul>
<li><strong>Training Instability</strong>: GANs can be difficult to
train due to issues like mode collapse, vanishing gradients, and
oscillations.</li>
<li><strong>Sensitive to Hyperparameters</strong>: GANs require careful
tuning of hyperparameters, such as learning rates and batch sizes, to
achieve stable training.</li>
<li><strong>Lack of Diversity</strong>: GANs may generate samples that
lack diversity, especially if the training data is limited or
biased.</li>
</ul>
<h1 id="analysis">Analysis</h1>
<h2 id="mode-collapse">Mode Collapse</h2>
<p>Mode collapse is a common issue in GAN training where the generator
produces a limited variety of outputs, often focusing on a few modes of
the data distribution. This can lead to a lack of diversity in generated
samples.</p>
<p>This is because the manifold of data is not necessarily connected
(MNIST), but the transformation from the noise space to the data space
is continuous. So it either gives up generating some data or generates
some data that is not actually in the data manifold. (In the vacant
middle of two number manifold).</p>
<p>See <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2001.03698">AE-OT-GAN</a>.</p>
<h2 id="training-difficulties">Training Difficulties</h2>
<p>Training GANs can be challenging due to the adversarial nature of the
training process. The more powerful the discriminator becomes, the
harder it is for the generator to produce samples that fool the
discriminator.</p>
<p>This is because the loss function has the problem of vanishing
gradients when the discriminator is too good at its job.</p>
<p>Fix <span class="math inline">\(G\)</span>, the optimal <span
class="math inline">\(D\)</span> is given by: <span
class="math display">\[
D^*(x)=\frac{p_{data}(x)}{p_{data}(x)+p_{g}(x)}
\]</span></p>
<p>Now we observe the loss of <span class="math inline">\(G\)</span> has
become: <span class="math display">\[
2JS(p_{data}||p_{g})-2\log 2
\]</span></p>
<p>But when the support of <span class="math inline">\(p_{data}\)</span>
and <span class="math inline">\(p_{g}\)</span> has no intersection, the
JS loss shall be constant. So the network cannot be trained since there
is no meaningful information can be acquired.</p>
<h1 id="wasserstein-gan-wgan">Wasserstein GAN (WGAN)</h1>
<p>Wasserstein GAN (WGAN) is a variant of GAN that addresses some of the
limitations of the original GAN formulation, particularly the issues
related to training stability and mode collapse. WGAN uses the
Wasserstein distance (also known as Earth Mover’s Distance) to measure
the distance between the real data distribution and the generated data
distribution.</p>
<p>See this article for more about Wasserstein distance: <a
href="https://notdesigned.github.io/2025/07/16/Wasserstein-Distance-and-Optimal-Transport/">Wasserstein
Distance and Optimal Transport</a></p>
<p>The important properties of Wasserstein distance are: 1.
<strong>Continuity</strong>: The Wasserstein distance is continuous with
respect to the distributions. 2. <strong>Metric</strong>: The
Wasserstein distance satisfies the triangle inequality and is a true
metric. 3. <strong>Independence of Support</strong>: When the supports
of two distributions have no overlap, Wasserstein distance still
provides a suitable gradient for the generator to update.</p>
<h2 id="formulation">Formulation</h2>
<p>The original Wasserstein is difficult to compute, so WGAN uses a
simplified version of the 1-Wasserstein distance, which can be computed
using the Kantorovich-Rubinstein duality:</p>
<p><span class="math display">\[
W(p_{data}, p_{g}) = \sup_{\|f\|_L \leq 1} \mathbb{E}_{x \sim
p_{data}}[f(x)] - \mathbb{E}_{x \sim p_{g}}[f(x)]
\]</span> Where <span class="math inline">\(f\)</span> is a 1-Lipschitz
function, <span class="math inline">\(\|f\|_L \leq 1\)</span>.</p>
<p>Actually if <span class="math inline">\(f\)</span> is a K-Lipschitz
function, just divide the result by <span
class="math inline">\(K\)</span>. So long as the function is finite
Lipschitz, it can be used to estimate the Wasserstein distance.</p>
<h2 id="modification-of-gan">Modification of GAN</h2>
<p>The loss function for the discriminator (critic) is modified to use
the Wasserstein distance instead of the original GAN loss. So the
objective becomes: <span class="math display">\[
\max_{D} L = \mathbb{E}_{x \sim p_{data}}[D(x)] - \mathbb{E}_{x \sim
p_{g}}[D(x)]
\]</span> The discriminator is now no longer trying to output
probabilities, but rather to output a real-valued score that reflects
the “realness” of the input data.</p>
<p>To ensure that <span class="math inline">\(D\)</span> is a
K-Lipschitz function, WGAN applies weight clipping to the
discriminator’s weights. This means that the weights of the
discriminator are constrained to lie within a certain range (e.g.,
[-0.01, 0.01]). So it must be limited to a finite Lipschitz
constant.</p>
<p>For the generator, since the first term is not dependent on <span
class="math inline">\(G\)</span>, the objective becomes: <span
class="math display">\[
\min_{G} L = -\mathbb{E}_{x \sim p_{g}}[D(x)]
\]</span></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Machine-Learning/" class="category-chain-item">Machine Learning</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Generative-Models/" class="print-no-link">#Generative Models</a>
      
        <a href="/tags/GAN/" class="print-no-link">#GAN</a>
      
        <a href="/tags/Wasserstein-Distance/" class="print-no-link">#Wasserstein Distance</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>GAN and Wasserstein GAN</div>
      <div>https://notdesigned.github.io/2025/07/22/GAN-and-Wasserstein-GAN/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Luocheng Liang</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>July 22, 2025</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - Share-alike">
                    <i class="iconfont icon-cc-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/07/30/Differential-Geometry/" title="Differential Geometry">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Differential Geometry</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/07/16/Wasserstein-Distance-and-Optimal-Transport/" title="Wasserstein Distance and Optimal Transport">
                        <span class="hidden-mobile">Wasserstein Distance and Optimal Transport</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://lib.baomitu.com/gitalk/1.8.0/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"Ov23lisUTr0Y3YpBngo1","clientSecret":"4068f2efc1d2d6015f3c8089a4e0ad4c1aeb8ed2","repo":"gitalkcomment","owner":"NotDesigned","admin":["NotDesigned"],"language":"en","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":false,"proxy":"https://autumn-recipe-17e3.theadscn.workers.dev/https://github.com/login/oauth/access_token"},
          {
            id: '36a1dc3f6461c09f465cb4521f225a2f'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
